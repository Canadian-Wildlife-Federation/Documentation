
<!DOCTYPE html>

<html lang="fr_CA">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Application Architecture &#8212; Documentation Canadian Aquatic Barriers Database 0.1</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_cwf_book.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../_static/main.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="CABD REST API Services" href="docs_tech_arch_api.html" />
    <link rel="prev" title="Acknowledgements" href="../docs_user/acknowledgements.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="fr_CA">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cwf_logo_2.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CABD User Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_user/whats_new.html">
   What’s new?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_user/cabd_overview.html">
   CABD Overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs_user/docs_user_web_map.html">
   The CABD Web Mapping Tool
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_components.html">
     Interface Components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_search.html">
     Searching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_data_vis.html">
     Visualizing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_attributes.html">
     Viewing Attribute Information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_filters.html">
     Filtering Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_download.html">
     Downloading Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_sources.html">
     Data Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_docs.html">
     Documentation Site
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_web_map/docs_user_web_map_tutorial_contact.html">
     Contact Us
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs_user/docs_user_data_sources.html">
   Data Sources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_user/docs_user_data_sources/docs_user_data_sources_csv_download.html">
     Feature Data Source Details Download
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_user/docs_user_data_catalogue.html">
   Data Catalogue
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_user/docs_user_submitted_updates.html">
   Submit Data Updates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_user/docs_user_engagement.html">
   Stakeholder Engagement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_user/acknowledgements.html">
   Acknowledgements
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CABD Technical Documents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Application Architecture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docs_tech_arch_api.html">
   CABD REST API Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docs_tech_arch_tiles.html">
   CHyF REST API Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docs_tech_feature_review.html">
   Data Processing Methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CHyF Documents
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_chyf/docs_chyf_logical_model.html">
   Logical Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs_chyf/docs_chyf_data_model.html">
   Data Model
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs_chyf/docs_chyf_tools.html">
   Processing Tools
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_chyf/docs_chyf_tools/docs_chyf_tools_flow_and_catch.html">
     Flowpath Constructor and Catchment Delineator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_chyf/docs_chyf_tools/docs_chyf_tools_stream_order.html">
     Stream Order
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_chyf/docs_chyf_tools/docs_chyf_tools_specification.html">
     Input Specifications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs_chyf/docs_chyf_process.html">
   Hydro Network Processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_chyf/docs_chyf_process/docs_chyf_process_steps.html">
     NHN - CHyF Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_chyf/docs_chyf_process/docs_chyf_process_stream_order.html">
     Calculating Stream Order
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs_chyf/docs_chyf_process/docs_chyf_process_troubleshoot.html">
     Troubleshooting
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            <p></p>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Canadian-Wildlife-Federation"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Canadian-Wildlife-Federation/issues/new?title=Issue%20on%20page%20%2Fdocs_tech/docs_tech_arch_models.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/github.com/Canadian-Wildlife-Federation/edit/master/docs_tech/docs_tech_arch_models.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/docs_tech/docs_tech_arch_models.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Document Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#existing-implementation">
   Existing Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#features-and-database-models">
   Features and Database Models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     CABD Feature Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generic-feature-model">
       Generic Feature Model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implemented-feature-model">
       Implemented Feature Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cabd-database-model">
     CABD Database Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-views">
       Feature Views
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-update-view">
       Feature Update View
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#core-tables">
       Core Tables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Shared Attribute Tables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-tables">
       Feature Tables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-type-attribute-data-sources">
       Feature Type Attribute Data Sources
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#audit-log-change-tracking">
       Audit Log / Change Tracking
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Application Architecture</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Document Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#existing-implementation">
   Existing Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#features-and-database-models">
   Features and Database Models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     CABD Feature Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generic-feature-model">
       Generic Feature Model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implemented-feature-model">
       Implemented Feature Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cabd-database-model">
     CABD Database Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-views">
       Feature Views
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-update-view">
       Feature Update View
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#core-tables">
       Core Tables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Shared Attribute Tables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-tables">
       Feature Tables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#feature-type-attribute-data-sources">
       Feature Type Attribute Data Sources
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#audit-log-change-tracking">
       Audit Log / Change Tracking
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <style> .codeblocksize {line-height: 2.5; font-size: x-large; background-color: rgb(175 184 193 / 20%); border-radius: 6px; color: #CC3600; padding: 0.2em 0.4em; padding-top: 0.2em; padding-right: 0.4em; padding-bottom: 0.2em; padding-left: 0.4em;}</style><section id="application-architecture">
<span id="id1"></span><h1>Application Architecture<a class="headerlink" href="#application-architecture" title="Lien permanent vers ce titre">#</a></h1>
<p>This section contains technical details about the current implementation of the Canadian Aquatic Barriers Database (CABD) back-end application, including feaure and vector tile services and the CABD data dictionary. The intended audience are software developers and similar technical users looking to upgrade/maintain the current system or use the API endpoints.</p>
<section id="existing-implementation">
<span id="current-application-architecture"></span><h2>Existing Implementation<a class="headerlink" href="#existing-implementation" title="Lien permanent vers ce titre">#</a></h2>
<hr class="docutils" />
<p>The current application runs on two Microsoft Azure Java Web App servers, <code class="docutils literal notranslate"><span class="pre">cabd-web</span></code> (for CABD data) and <code class="docutils literal notranslate"><span class="pre">chyf-web</span></code> (for CHyF data).</p>
<img alt="../_images/app-arch3.jpg" class="align-center" src="../_images/app-arch3.jpg" />
</section>
<section id="features-and-database-models">
<span id="cabd-models"></span><span id="cabd-feature-model"></span><h2>Features and Database Models<a class="headerlink" href="#features-and-database-models" title="Lien permanent vers ce titre">#</a></h2>
<hr class="docutils" />
<section id="id2">
<h3>CABD Feature Model<a class="headerlink" href="#id2" title="Lien permanent vers ce titre">#</a></h3>
<section id="generic-feature-model">
<span id="id3"></span><h4>Generic Feature Model<a class="headerlink" href="#generic-feature-model" title="Lien permanent vers ce titre">#</a></h4>
<p>Features in CABD have an optional hierarchical structure. Feature types can be combined to form “super feature types”.</p>
<p>There are no structures in the software/database that enforce this model. The database views (see section below) are used to define the various feature types and super types. It would be possible for a feature type to be associated with multiple super types, if desired.</p>
<a class="reference internal image-reference" href="../_images/genericmodel.jpg"><img alt="../_images/genericmodel.jpg" class="align-center" src="../_images/genericmodel.jpg" style="width: 500px;" /></a>
</section>
<section id="implemented-feature-model">
<span id="id4"></span><h4>Implemented Feature Model<a class="headerlink" href="#implemented-feature-model" title="Lien permanent vers ce titre">#</a></h4>
<p>There are currently three feature types and one super type implemented in CABD. Adding additional feature types is expected and the instructions for this are outlined below (How to add new Feature Type).</p>
<a class="reference internal image-reference" href="../_images/implementedmodel.jpg"><img alt="../_images/implementedmodel.jpg" class="align-center" src="../_images/implementedmodel.jpg" style="width: 500px;" /></a>
<p>Feature types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">barriers</span></code> - a super feature type that includes dams, other structures, and waterfalls.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dams</span></code> - a feature type for features classified as a dam or other structure.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">waterfalls</span></code> - a feature type for features classified as a waterfall.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fishways</span></code> - a feature type for features classified as a fish passage structure.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">medium</span></code> - a feature type created for testing the increase in data volume expected for stream crossing data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">big</span></code> - a feature type created for testing the increase in data volume expected for stream crossing data.</p></li>
</ul>
</section>
</section>
<section id="cabd-database-model">
<span id="id5"></span><h3>CABD Database Model<a class="headerlink" href="#cabd-database-model" title="Lien permanent vers ce titre">#</a></h3>
<p>The database is structured into multiple schemas.  Each feature type has its own schema, with a common <code class="docutils literal notranslate"><span class="pre">cabd</span></code> schema for shared data and feature metadata.</p>
<section id="feature-views">
<span id="cabd-feature-views"></span><h4>Feature Views<a class="headerlink" href="#feature-views" title="Lien permanent vers ce titre">#</a></h4>
<p>Each feature type and super feature type has two associated views which support the API - one view for Engligh (_en) and one view for French (_fr). These views should include all fields required for output (either for display on the UI or to support the future editing API).</p>
<p><span class="raw-html"><p>The view <span class="cbm">cabd.all_features_view_<span class="cbmcc">&lt;en/fr&gt</span></span> supports all feature api endpoints.</p></span></p>
<p>Views are used to support the CABD APIs that list features. Each feature type is linked to a database view. When requesting features of a specific type the view associated with this type is queried. The fields returned by this view populate the attributes of the feature returned by the API. Feature type views will generally query a single data table (for example, the <code class="docutils literal notranslate"><span class="pre">dams</span></code> view queries the dams data table). Super feature types will generally query multiple data tables (for example, the <code class="docutils literal notranslate"><span class="pre">barriers</span></code> view queries both the dams data table and the waterfalls data table).</p>
</section>
<section id="feature-update-view">
<span id="cabd-feature-update-view"></span><h4>Feature Update View<a class="headerlink" href="#feature-update-view" title="Lien permanent vers ce titre">#</a></h4>
<p>By design each feature includes an updates_pending attribute that is populated with true or false depending on if there are feature updates pending review in the system. This field is populated by the system using the <code class="docutils literal notranslate"><span class="pre">cabd.updates_pending</span></code> view. This view should return a single column, cabd_id, for each feature that has a review pending in the database.</p>
</section>
<section id="core-tables">
<span id="id6"></span><h4>Core Tables<a class="headerlink" href="#core-tables" title="Lien permanent vers ce titre">#</a></h4>
<p>These tables are the core tables for the system and required regardless of the feature types loaded. They support the definition of feature types.</p>
<p><span class="codeblocksize">cabd.feature_types</span></p>
<p>Lists all the feature types supported by the system.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p>Unique identifier for feature type. Required.</p></td>
</tr>
<tr class="row-odd"><td><p>data_view</p></td>
<td><p>The root name of the data view supporting the feature type. This is the view name without the language suffix (ex. dams_view). Required.</p></td>
</tr>
<tr class="row-even"><td><p>name_en</p></td>
<td><p>The English human readable name for the feature type. Required.</p></td>
</tr>
<tr class="row-odd"><td><p>name_fr</p></td>
<td><p>The English human readable name for the feature type. Required.</p></td>
</tr>
<tr class="row-even"><td><p>attribute_source_table</p></td>
<td><p>The data table containing the attribute data source information for the feature type. This is optional and can be null.</p></td>
</tr>
<tr class="row-odd"><td><p>default_featurename_field</p></td>
<td><p>The field in the data_view that represents the main feature name.</p></td>
</tr>
<tr class="row-even"><td><p>feature_source_table</p></td>
<td><p>The data table containing a link between the features and the data source information. This is optional and can be null.</p></td>
</tr>
<tr class="row-odd"><td><p>data_version</p></td>
<td><p>The version number of the data for the feature type. This version number is included in exports.</p></td>
</tr>
</tbody>
</table>
<p><span class="codeblocksize">cabd.feature_type_metadata</span></p>
<p>Lists all the attributes for a given feature view and the metadata details about the attribute.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>view_name</p></td>
<td><p>The data view name.</p></td>
</tr>
<tr class="row-odd"><td><p>field_name</p></td>
<td><p>The field name in the data view that represents this attribute.</p></td>
</tr>
<tr class="row-even"><td><p>name_en</p></td>
<td><p>The English name of the attribute.</p></td>
</tr>
<tr class="row-odd"><td><p>name_fr</p></td>
<td><p>The French name of the attribute.</p></td>
</tr>
<tr class="row-even"><td><p>description_en</p></td>
<td><p>An English description of the attribute.</p></td>
</tr>
<tr class="row-odd"><td><p>description_fr</p></td>
<td><p>A French description of the attribute.</p></td>
</tr>
<tr class="row-even"><td><p>is_link</p></td>
<td><p>Boolean.  If true this attribute will be treated as a URL in the API. The value will be returned in URL format (For example: link to another feature).</p></td>
</tr>
<tr class="row-odd"><td><p>data_type</p></td>
<td><p>The data type for the attribute. Valid values: varchar(xxx), text, boolean, array(type), integer, double, uuid, date, geometry.</p></td>
</tr>
<tr class="row-even"><td><p>vw_simple_order</p></td>
<td><p>Metadata for the UI. The UI supports a simple and all attribute view. This field represents the order the attribute should appear in the simple ui view. The value should be null for attributes that should not appear in the simple view.</p></td>
</tr>
<tr class="row-odd"><td><p>vw_all_order</p></td>
<td><p>Metadata for the UI. The UI supports a simple and all attribute view. This field represents the order the attribute should appear in the all attribute view. Should be null for attributes that should not appear in the view.</p></td>
</tr>
<tr class="row-even"><td><p>include_vector_tile</p></td>
<td><p>Boolean.  If true this attribute will be included in the vector tile service.</p></td>
</tr>
<tr class="row-odd"><td><p>value_options_reference</p></td>
<td><p>For columns that have a defined list of valid values in another database table (for example: <code class="docutils literal notranslate"><span class="pre">province_territory_code</span></code>), this field identifies what table the values can be loaded from and what fields in the table that provide the value, name, and description. This column should be null for fields that don’t reference tables.</p>
<p>The string should be of the form <code class="docutils literal notranslate"><span class="pre">&lt;tablename&gt;;&lt;valuefield&gt;;&lt;namefield&gt;;&lt;descriptionfield&gt;</span></code>. All are required except <code class="docutils literal notranslate"><span class="pre">valuefield</span></code> and <code class="docutils literal notranslate"><span class="pre">descriptionfield</span></code> which can be blank.  The <code class="docutils literal notranslate"><span class="pre">tablename</span></code> references the code table, the <code class="docutils literal notranslate"><span class="pre">valuefield</span></code> the value field in the code table, the <code class="docutils literal notranslate"><span class="pre">namefield</span></code> the human friendly name field in the table, and <code class="docutils literal notranslate"><span class="pre">descriptionfield</span></code> the description field in the table. The name and description fields should exclude the language suffix and each reference table should have both _en and _fr columns for the name and description fields.</p>
<p>For example: <code class="docutils literal notranslate"><span class="pre">dams.use_codes;code;name;description</span></code> or <code class="docutils literal notranslate"><span class="pre">cabd.province_territory_codes;code;name;</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p>is_name_search</p></td>
<td><p>True if field to be included in the name API search. Should be set to true fo any attributes that represent the feature name or want to include when searching by name.</p></td>
</tr>
</tbody>
</table>
<p><span class="codeblocksize">cabd.data_source</span></p>
<p>Lists data sources. Supports data source tracking for feature type attributes.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>A unique identifier for the data source.</p></td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><p>Name of the data source (matches short names listed on the <a class="reference external" href="https://cabd-docs.netlify.app/docs_user/docs_user_data_sources.html">data sources page</a>).</p></td>
</tr>
<tr class="row-even"><td><p>version_date</p></td>
<td><p>Data source version date.</p></td>
</tr>
<tr class="row-odd"><td><p>version_number</p></td>
<td><p>Data source version number (optional).</p></td>
</tr>
<tr class="row-even"><td><p>source</p></td>
<td><p>A link to the source data or full reference and description of where the source data came from.</p></td>
</tr>
<tr class="row-odd"><td><p>comments</p></td>
<td><p>Any additional comments about the data source.</p></td>
</tr>
<tr class="row-even"><td><p>source_type</p></td>
<td><p>Type of data source (spatial or non-spatial).</p></td>
</tr>
</tbody>
</table>
<p id="shared-attribute-tables"><span class="codeblocksize">cabd.contacts</span></p>
<p>A list of contacts relevant to the CABD database.  Currently, contacts are only created when a user submits a feature update.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>unique system generated number</p></td>
</tr>
<tr class="row-odd"><td><p>email</p></td>
<td><p>Users email</p></td>
</tr>
<tr class="row-even"><td><p>name</p></td>
<td><p>Users name</p></td>
</tr>
<tr class="row-odd"><td><p>organization</p></td>
<td><p>(Optional) Organization associated with the user</p></td>
</tr>
<tr class="row-even"><td><p>datasource_id</p></td>
<td><p>(Optional) Link to the cabd.data_source table which represents the datasource associated with this user.</p></td>
</tr>
</tbody>
</table>
<p><span class="codeblocksize">cabd.user_feature_updates</span></p>
<p>Users can use the Features API to submit updates to features. All submissions are stored in this table.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>unique system generated identifier</p></td>
</tr>
<tr class="row-odd"><td><p>datetime</p></td>
<td><p>Date time of submission</p></td>
</tr>
<tr class="row-even"><td><p>contact_id</p></td>
<td><p>Link to the contact who submitted the change</p></td>
</tr>
<tr class="row-odd"><td><p>cabd_id</p></td>
<td><p>Link to the feature the update references</p></td>
</tr>
<tr class="row-even"><td><p>cabd_type</p></td>
<td><p>CABD feature type</p></td>
</tr>
<tr class="row-odd"><td><p>user_description</p></td>
<td><p>The user provided description of the update</p></td>
</tr>
<tr class="row-even"><td><p>user_data_source</p></td>
<td><p>The user provided data source</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>Internal field representing the status of the update. This is managed by the CABD administrators.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id7">
<h4>Shared Attribute Tables<a class="headerlink" href="#id7" title="Lien permanent vers ce titre">#</a></h4>
<p>All of these tables store data that are shared between multiple feature types. Generally, each of these tables have a unique code (for references), a name, and a description.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.barrier_ownership_type_codes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.fish_species</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.nhn_workunit</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.passability_status_codes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.province_territory_codes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.upstream_passage_type_codes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cabd.census_subdivisions</span></code></p></li>
</ul>
</section>
<section id="feature-tables">
<span id="id8"></span><h4>Feature Tables<a class="headerlink" href="#feature-tables" title="Lien permanent vers ce titre">#</a></h4>
<p>The feature type data tables are found in their corresponding schema. Generally, there will be one feature data table and a number of reference tables that represent attribute values.  Details for current feature types can be found in the Data Dictionary document.</p>
</section>
<section id="feature-type-attribute-data-sources">
<span id="id9"></span><h4>Feature Type Attribute Data Sources<a class="headerlink" href="#feature-type-attribute-data-sources" title="Lien permanent vers ce titre">#</a></h4>
<p>The CABD database has the option of storing the data source for each attribute associated with the feature type. This has been implemented by having <code class="docutils literal notranslate"><span class="pre">&lt;featuretype&gt;.&lt;featuretype&gt;_feature_source</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;featuretype&gt;.&lt;featuretype&gt;_attribute_source</span></code> tables for the feature type (e.g., <code class="docutils literal notranslate"><span class="pre">dams.dams_feature_source</span></code> and <code class="docutils literal notranslate"><span class="pre">dams.dams_attribute_source</span></code>).</p>
<p>For each cabd feature, the <code class="docutils literal notranslate"><span class="pre">&lt;featuretype&gt;_feature_source</span></code>  table contains a link to the data sources and associated data source feature ids that the feature was found in. For example, a dam feature that was found in both the nrcan_canvec_mm and bceccs_fiss data sources would have two entries for its <code class="docutils literal notranslate"><span class="pre">cabd_id</span></code> in the <code class="docutils literal notranslate"><span class="pre">&lt;featuretype&gt;_feature_source</span></code> table.</p>
<p><span class="codeblocksize">&lt;featuretype&gt;_feature_source</span></p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cabd_id</p></td>
<td><p>The unique cabd feature identifier. This id must exist in the corresponding data table for the feature type.</p></td>
</tr>
<tr class="row-odd"><td><p>datasource_id</p></td>
<td><p>A link to the data source id in the cabd.data_source table</p></td>
</tr>
<tr class="row-even"><td><p>datasource_feature_id</p></td>
<td><p>The identifier of the feature in the data source.</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;featuretype&gt;_attribute_source</span></code> table contains the cabd_id and one column for each attribute that requires data source tracking.  The column, <code class="docutils literal notranslate"><span class="pre">&lt;attribute&gt;_ds</span></code>, links to the <code class="docutils literal notranslate"><span class="pre">cabd.data_source</span> <span class="pre">table</span></code> to identify the data source for the attribute value.</p>
<p><span class="codeblocksize">&lt;featuretype&gt;_attribute_source</span></p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cabd_id</p></td>
<td><p>The unique cabd feature identifier. This id must exist in the corresponding data table for the feature type.</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;attribute1&gt;_ds</p></td>
<td><p>A link to the data source id in the cabd.data_source table that &lt;attribute1&gt; comes from for the feature.</p></td>
</tr>
<tr class="row-even"><td><p>&lt;attribute2&gt;_ds</p></td>
<td><p>A link to the data source id in the cabd.data_source table that &lt;attribute2&gt; comes from for the feature.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="audit-log-change-tracking">
<span id="audit-log"></span><h4>Audit Log / Change Tracking<a class="headerlink" href="#audit-log-change-tracking" title="Lien permanent vers ce titre">#</a></h4>
<p>The CABD database has tracks changes to the following tables:</p>
<ul class="simple">
<li><p>cabd.contacts</p></li>
<li><p>cabd.fish_species</p></li>
<li><p>cabd.data_source</p></li>
<li><p>dams.dams</p></li>
<li><p>dams.dams_attribute_source</p></li>
<li><p>dams.dams_feature_source</p></li>
<li><p>waterfalls.waterfalls</p></li>
<li><p>waterfalls.waterfalls_attribute_source</p></li>
<li><p>waterfalls.waterfalls_feature_source</p></li>
<li><p>fishways.fishways</p></li>
<li><p>fishways.fishways_attribute_source</p></li>
<li><p>fishways.fishways_feature_source</p></li>
<li><p>fishways.species_mapping</p></li>
</ul>
<p>New feature types can also include change tracking by applying the appropriate triggers to any new database tables that require change tracking.</p>
<p>All changes are logged in the <code class="docutils literal notranslate"><span class="pre">cabd.audit_log</span></code> table. This table has the following columns:</p>
<span class="target" id="id10"></span></section>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../docs_user/acknowledgements.html" title="précédent page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">précédent</p>
            <p class="prev-next-title">Acknowledgements</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="docs_tech_arch_api.html" title="suivant page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">CABD REST API Services</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2022, Canadian Wildlife Federation.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>